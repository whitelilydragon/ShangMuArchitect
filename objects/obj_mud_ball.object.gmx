<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>spr_mud_balls</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>-7</depth>
  <persistent>0</persistent>
  <parentName>obj_flood_ball</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>event_inherited()
flood_particle_sprites = spr_mud_pools
main_sprite_visible = true
cube_jiggle = 0
cube_jiggle_scale = 0
cube_jiggle_timer = 10
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>//----------------------------------//
//       Basic Gravity System       //
//----------------------------------//

if obj_game_logic.pause = 0

{

var floor_center = tile_layer_find(surface_flats,x,y);

//If we are not at the speed cap, apply acceleration.
if !tile_exists(floor_center) and gravity_speed&lt;gravity_cap
    gravity_speed+=gravity_accel;

if gravity_speed &gt; gravity_cap
    gravity_speed = gravity_cap;

//Jiggle if we've gotten bounced off of
if cube_jiggle_timer &gt; 0
    {
        cube_jiggle_timer -= 1
        switch(cube_jiggle_timer)
            {
                case 9: {cube_jiggle_scale = 0.5; break;}
                case 6: {cube_jiggle_scale = 0.15; break;}
                case 4: {cube_jiggle_scale = 0.65; break;}
                case 3: {cube_jiggle_scale = 0.25; break;}
                case 2: {cube_jiggle_scale = 0.45; break;}
                case 1: {cube_jiggle_scale = 0; break;}
            }
    }
else
    cube_jiggle_timer = 10;
cube_jiggle = lerp(cube_jiggle,cube_jiggle_scale,0.5)

if tile_exists(floor_center)
    {
        y = tile_get_y(floor_center);
        ground = 1
        gravity_speed = 0
        angle = 0
    }
else
    {
        ground = 0;
    }

//Sloped Floor Collisions
var tile_ramp_id = tile_layer_find(surface_slopes,x,y);

//If we are colliding with a slope tile, clip to its surface based on X position
if tile_exists(tile_ramp_id)
    {
        //Collect Background ID of the Tile
        var tile_ramp_asset = obj_game_logic.enemy_slopes[tile_get_background(tile_ramp_id)];

        //Get Gem Coordinates Relative to the Tile's Origins
        var tile_ramp_pos_0=abs(tile_get_x(tile_ramp_id)-x)   //Get X
        var tile_ramp_pos_1=abs(tile_get_y(tile_ramp_id)-y)   //Get Y

                //If tile was not flagged as "ignore", read its collision data
                if tile_ramp_asset != -1
                    {
                        //Check If Gem Y is Greater Than Slope's Current Height
                        if tile_ramp_pos_1 &gt;= obj_game_logic.orig_clip[tile_ramp_asset,tile_ramp_pos_0]
                            {
                                gravity_slope=1
                            }
                        if obj_game_logic.orig_clip[tile_ramp_asset,tile_ramp_pos_0] = -1
                            gravity_slope = 0;
                        if gravity_slope = 1
                            {
                                //If We Are Colliding with Slope, Clip to its Y Coordinates
                                y = floor(tile_get_y(tile_ramp_id))+obj_game_logic.orig_clip[tile_ramp_asset,tile_ramp_pos_0]
                                gravity_speed=0
                                angle = obj_game_logic.orig_clip[tile_ramp_asset+obj_game_logic.scr_local_angles,tile_ramp_pos_0]
                            }
                    }
    }
else
    {
        gravity_slope = 0
        angle = 90
        if sprite_index = spr_mud_pools
            sprite_index = spr_mud_balls;
        if ground = 1
            angle = 0;
    }

//Clean slope tile variables when collisions are done
if !tile_exists(tile_ramp_id)
    gravity_slope = 0;

//Apply Gravity Speed to Y Coordinates
if gravity_slope = 0 and ground = 0
    {
        y+=gravity_speed;
    }

//Animate flood particles
flood_frame[0] += 0.25
if flood_frame[0] &gt; 2
    {
        flood_frame[0] = 0;
    }
flood_splatter_frame += 0.40
if flood_splatter_frame &gt; 3.8
    {
        flood_splatter_frame = 0;
    }

if gravity_speed = 0
    {
        sprite_index = spr_mud_pools
        main_sprite_visible = true
        flood_timer += 2
        if flood_iterate &lt;= 24
            {
                if gravity_slope = 1 or ground = 1
                    {
                        x += 2*flood_direction
                    }
            }
        if flood_timer = 8
            {
                scr_set_flood_balls(self,flood_particle_iterate);
                flood_timer = 0
                flood_iterate += 1
                flood_particle_iterate += 1
                if flood_particle_iterate &gt; 6
                    flood_particle_iterate = 0;
            }
        if !audio_is_playing(snd_water_trickle)
            audio_play_sound(snd_water_trickle,50,false);
    }
else
    {
        if flood_iterate &gt; 0 flood_iterate = 25;
    }
if flood_iterate &gt; 24
    {
        if gravity_speed = 0
            main_sprite_visible = false;
        flood_taper_timer += 1
        if flood_taper_timer = 60
            flood_visible[6] = false
        if flood_taper_timer = 76
            flood_visible[5] = false
        if flood_taper_timer = 92
            flood_visible[4] = false
        if flood_taper_timer = 108
            flood_visible[3] = false
        if flood_taper_timer = 124
            flood_visible[2] = false
        if flood_taper_timer = 140
            flood_visible[1] = false
        if flood_taper_timer = 156
            flood_visible[0] = false
        if flood_taper_timer = 172
            instance_destroy();
    }

if flood_visible[0] = true
    {
        var circle_ID = collision_circle(flood_x[0],flood_y[0],16,obj_enemy_parent,false,true);
        if instance_exists(circle_ID)
            {
                circle_ID.slip_timer = 16
                circle_ID.weather_slip_target = 2*flood_direction
            }
        var circle_ID = collision_circle(flood_x[0],flood_y[0],16,obj_mega_crate,false,true);
        if instance_exists(circle_ID)
            {
                circle_ID.slip_timer = 16
                circle_ID.weather_slip_target = 2*flood_direction
            }
    }


if y &gt; obj_game_logic.water_height
or y &gt; room_height
    instance_destroy();
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if main_sprite_visible = true
    {
        draw_sprite_ext(sprite_index,0,x,y,1,1,angle,c_white,1)
    }

var it = 0;
while(it &lt;= 3)
    {
        if flood_visible[it] = true
            {
                draw_sprite_ext(flood_particle_sprites,0,flood_x[it],flood_y[it],1+cube_jiggle,1-(cube_jiggle/3),flood_angle[it],c_white,1)
                draw_sprite_ext(spr_rain_particles,flood_splatter_frame,flood_x[it],flood_y[it],1,1,flood_angle[it],c_white,1)
            }
        it += 1
    }
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
